<!DOCTYPE html>
<html lang="uk">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</title>
    <link rel="stylesheet" href="./assets/css/styles.css" />
</head>

<body>
    <header class="main-header">
        <div class="logo">
            <h1><a href="index.html">üõçÔ∏è TSTYL</a></h1>
        </div>
        <button onclick="toggleTheme()">üåì</button>
    </header>

    <main class="container">
        <h2>–ê–¥–º—ñ–Ω-–ø–∞–Ω–µ–ª—å</h2>
        <form id="add-product-form">
            <input type="text" id="name" placeholder="–ù–∞–∑–≤–∞ —Ç–æ–≤–∞—Ä—É" required />
            <input type="number" id="price" placeholder="–¶—ñ–Ω–∞" required />
            <input type="text" id="image" placeholder="–ó–æ–±—Ä–∞–∂–µ–Ω–Ω—è (images/–Ω–∞–∑–≤–∞.jpg)" required />
            <input type="text" id="category" placeholder="–ö–∞—Ç–µ–≥–æ—Ä—ñ—è" required />
            <textarea id="description" placeholder="–û–ø–∏—Å —Ç–æ–≤–∞—Ä—É"></textarea>
            <button type="submit">–î–æ–¥–∞—Ç–∏ —Ç–æ–≤–∞—Ä</button>
        </form>

        <h3>–£—Å—ñ —Ç–æ–≤–∞—Ä–∏</h3>
        <div id="admin-product-list" class="grid"></div>
    </main>

    <script>
        if (localStorage.getItem('theme') === 'dark') {
            document.body.classList.add('dark');
        }
        function toggleTheme() {
            document.body.classList.toggle('dark');
            localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
        }

        const defaultProducts = [
            { id: 1, name: "–§—É—Ç–±–æ–ª–∫–∞ –±—ñ–ª–∞", price: 500, category: "–§—É—Ç–±–æ–ª–∫–∏", image: "images/product1.jpg", description: "–õ–µ–≥–∫–∞ —Ñ—É—Ç–±–æ–ª–∫–∞", available: true },
            { id: 2, name: "–ö–æ—Å—Ç—é–º", price: 700, category: "–ö–æ—Å—Ç—é–º–∏", image: "images/product2.jpg", description: "–ï–ª–µ–≥–∞–Ω—Ç–Ω–∏–π –∫–æ—Å—Ç—é–º", available: true },
            { id: 3, name: "–ö—É—Ä—Ç–∫–∞", price: 5100, category: "–ö—É—Ä—Ç–∫–∏", image: "images/product3.jpg", description: "–¢–µ–ø–ª–∞ –∫—É—Ä—Ç–∫–∞", available: true },
            { id: 4, name: "–ö—Ä–æ—Å—Å–æ–≤–∫–∏", price: 4100, category: "–ö—Ä–æ—Å—Å–æ–≤–∫–∏", image: "images/product4.jpg", description: "–°–ø–æ—Ä—Ç–∏–≤–Ω–µ –≤–∑—É—Ç—Ç—è", available: true },
            { id: 5, name: "–§—É—Ç–±–æ–ª–∫–∞ —Å—ñ—Ä–∞", price: 500, category: "–§—É—Ç–±–æ–ª–∫–∏", image: "images/product5.jpg", description: "–õ–µ–≥–∫–∞ —Ñ—É—Ç–±–æ–ª–∫–∞", available: true },
            { id: 6, name: "–§—É—Ç–±–æ–ª–∫–∞ —Å—Ç—Ä–µ–π—á–æ–≤–∞ —Å—ñ—Ä–∞", price: 500, category: "–§—É—Ç–±–æ–ª–∫–∏", image: "images/product6.jpg", description: "–õ–µ–≥–∫–∞ —Ñ—É—Ç–±–æ–ª–∫–∞", available: true },
            { id: 7, name: "–ö—Ä—É—Ç–∏–π –∫–æ–º–ø–ª–µ–∫—Ç/–ö–æ—Å—Ç—é–º", price: 1900, category: "–ö–æ—Å—Ç—é–º–∏", image: "images/product7.jpg", description: "–ï–ª–µ–≥–∞–Ω—Ç–Ω–∏–π –∫–æ—Å—Ç—é–º", available: true }
        ];

        let adminProducts = JSON.parse(localStorage.getItem("adminProducts")) || [];
        let allProducts = [...defaultProducts, ...adminProducts];

        const form = document.getElementById("add-product-form");
        const list = document.getElementById("admin-product-list");

        function renderProducts() {
            list.innerHTML = "";
            allProducts.forEach((product, index) => {
                const isEditable = index >= defaultProducts.length;
                const availableText = product.available === false ? "‚ùå –ù–µ–º–∞—î –≤ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ" : "‚úÖ –£ –Ω–∞—è–≤–Ω–æ—Å—Ç—ñ";
                const id = product.id;

                list.innerHTML += `
          <div class="card" id="product-${id}">
            <img src="${product.image}" alt="${product.name}" />
            <div class="card-body">
              <h3 id="name-${id}">${product.name}</h3>
              <p id="price-${id}">${product.price} –≥—Ä–Ω</p>
              <p id="category-${id}"><small>${product.category}</small></p>
              <p id="desc-${id}">${product.description}</p>
              <p id="status-${id}">${availableText}</p>
              ${isEditable ? `
                <button onclick="toggleAvailability(${index})">üîÅ –ó–º—ñ–Ω–∏—Ç–∏ —Å—Ç–∞—Ç—É—Å</button>
                <button onclick="editProduct(${index})">‚úèÔ∏è –†–µ–¥–∞–≥—É–≤–∞—Ç–∏</button>
                <button onclick="deleteProduct(${index})">üóëÔ∏è –í–∏–¥–∞–ª–∏—Ç–∏</button>
              ` : `<p><em>üì¶ –í–±—É–¥–æ–≤–∞–Ω–∏–π —Ç–æ–≤–∞—Ä (–Ω–µ —Ä–µ–¥–∞–≥—É—î—Ç—å—Å—è)</em></p>`}
            </div>
          </div>
        `;
            });
        }

        function editProduct(index) {
            const product = allProducts[index];
            const card = document.getElementById(`product-${product.id}`);
            card.innerHTML = `
        <div class="card-body">
          <input type="text" id="edit-name-${index}" value="${product.name}" />
          <input type="number" id="edit-price-${index}" value="${product.price}" />
          <input type="text" id="edit-image-${index}" value="${product.image}" />
          <input type="text" id="edit-category-${index}" value="${product.category}" />
          <textarea id="edit-desc-${index}">${product.description}</textarea>
          <button onclick="saveEdit(${index})">üíæ –ó–±–µ—Ä–µ–≥—Ç–∏</button>
          <button onclick="renderProducts()">‚ùå –°–∫–∞—Å—É–≤–∞—Ç–∏</button>
        </div>
      `;
        }

        function saveEdit(index) {
            const updated = {
                ...adminProducts[index - defaultProducts.length],
                name: document.getElementById(`edit-name-${index}`).value,
                price: parseFloat(document.getElementById(`edit-price-${index}`).value),
                image: document.getElementById(`edit-image-${index}`).value,
                category: document.getElementById(`edit-category-${index}`).value,
                description: document.getElementById(`edit-desc-${index}`).value
            };
            adminProducts[index - defaultProducts.length] = updated;
            localStorage.setItem("adminProducts", JSON.stringify(adminProducts));
            allProducts = [...defaultProducts, ...adminProducts];
            renderProducts();
        }

        function toggleAvailability(index) {
            const realIndex = index - defaultProducts.length;
            if (realIndex >= 0) {
                adminProducts[realIndex].available = !adminProducts[realIndex].available;
                localStorage.setItem("adminProducts", JSON.stringify(adminProducts));
                allProducts = [...defaultProducts, ...adminProducts];
                renderProducts();
            }
        }

        function deleteProduct(index) {
            const realIndex = index - defaultProducts.length;
            if (realIndex >= 0) {
                adminProducts.splice(realIndex, 1);
                localStorage.setItem("adminProducts", JSON.stringify(adminProducts));
                allProducts = [...defaultProducts, ...adminProducts];
                renderProducts();
            }
        }

        form.addEventListener("submit", function (e) {
            e.preventDefault();
            const newProduct = {
                id: Date.now(),
                name: document.getElementById("name").value,
                price: parseFloat(document.getElementById("price").value),
                image: document.getElementById("image").value,
                category: document.getElementById("category").value,
                description: document.getElementById("description").value,
                available: true
            };
            adminProducts.push(newProduct);
            localStorage.setItem("adminProducts", JSON.stringify(adminProducts));
            allProducts = [...defaultProducts, ...adminProducts];
            form.reset();
            renderProducts();
        });

        renderProducts();
    </script>
</body>

</html>